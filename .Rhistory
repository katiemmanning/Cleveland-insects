##Pollinator GR richness linear model
richmodel.p <- lmer(richness~Date + design + Trap + (1|Site:Replicate), data=greenroofpollinators)  #AIC = 355
summary(richmodel.p)
AIC(richmodel.p)
anova(richmodel.p)
rich.emm<-emmeans(richmodel.p,pairwise~design) #comparing SE v BE
rich.emm
rich.emm.t<-emmeans(richmodel.p,pairwise~Trap)
rich.emm.t
##Pollinator GR abundance linear model
abunmodel.p <- lmer(abundance~Date + design + Trap + (1|Site:Replicate), data=greenroofpollinators)  #AIC = 1094
summary(abunmodel.p)
AIC(abunmodel.p)
anova(abunmodel.p)
abun.emm<-emmeans(abunmodel.p,pairwise~design)
abun.emm
#results: no difference between SE and BE (p=0.0969)
abun.cld<-multcomp::cld(abun.emm, alpha = 0.05, Letters = LETTERS)
abun.cld
abun.emm.t<-emmeans(abunmodel.p,pairwise~Trap)
abun.emm.t
##Pollinator GR diversity linear model
divmodel.p <- lmer(diversity~Date + design + Trap + (1|Site:Replicate), data=greenroofpollinators)  #AIC = -168
summary(divmodel.p)
AIC(divmodel.p)
anova(divmodel.p)
div.emm<-emmeans(divmodel.p,pairwise~design)
div.emm
#results: no difference btw SE and BE green roofs (p=0.4633)
div.cld<-multcomp::cld(div.emm, alpha = 0.05, Letters = LETTERS)
div.cld
div.emm.t<-emmeans(divmodel.p,pairwise~Trap)
div.emm.t
#results: bowl sig diff from all trap types (bowls caught highest div, then ramps) - no diff btw rest
div.cld.t<-multcomp::cld(div.emm.t, alpha = 0.05, Letters = LETTERS)
div.cld.t
##Pollinator GR evenness linear model
evenmodel.p <- lmer(evenness~Date + design + Trap + (1|Site:Replicate), data=greenroofpollinators)  #AIC = -4
summary(evenmodel.p)
AIC(evenmodel.p)
anova(evenmodel.p)
even.emm<-emmeans(evenmodel.p,pairwise~design)
even.emm
#results: no difference btw SE and BE green roofs (p = 0.6687)
even.cld<-multcomp::cld(even.emm, alpha = 0.05, Letters = LETTERS)
even.cld
even.emm.t<-emmeans(evenmodel.p,pairwise~Trap)
even.emm.t
#results: bowl sig diff from all trap types (bowls most even, then ramps) - no diff btw rest
even.cld.t<-multcomp::cld(even.emm.t, alpha = 0.05, Letters = LETTERS)
even.cld.t
richness.plot.p_gr<-ggplot(greenroofpollinators, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = richness, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=rich.cld, aes(y = 25, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
richness.plot.p_gr
#site abundance by site type
abundance.plot.p_gr<-ggplot(greenroofpollinators, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = abundance, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=abun.cld, aes(y = 25, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
abundance.plot.p_gr
#site diversity by site type
diversity.plot.p_gr<-ggplot(greenroofpollinators, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = diversity, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Diversity")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=div.cld.s, aes(y = 2, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
diversity.plot.p_gr
#site evenness by site type
evenness.plot.p_gr<-ggplot(greenroofpollinators, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = evenness, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=even.cld.s, aes(y = 25, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
evenness.plot.p_gr
pollinator.gr_boxplot <- ggarrange(richness.plot.p_gr, diversity.plot.p_gr,
#labels = c("A", "B", "C", "D"),
ncol = 1, nrow = 4,
common.legend = TRUE, legend = "bottom")
pollinator.gr_boxplot <- ggarrange(richness.plot.p_gr, diversity.plot.p_gr,
#labels = c("A", "B", "C", "D"),
ncol = 1, nrow = 2,
common.legend = TRUE, legend = "bottom")
pollinator.gr_boxplot
pdf("pollinator.gr_boxplot.pdf", height=8, width=8) #height and width in inches
pollinator.gr_boxplot
dev.off()
#Natural enemies
#add data subset for green roof sites
greenroofNE <- NE[ which(NE$sitetype=="Greenroof"), ]
#add column for green roof functional intent (stormwater-energy and biodiversity-ecological)
greenroofNE$design<-ifelse(greenroofNE$Site=="EWB", "SE",
ifelse(greenroofNE$Site=="WSC", "SE", "BE"))
str(greenroofNE)
##Natural GR enemy richness linear model
richmodel.n <- lmer(richness~Date + design + Trap + (1|Site:Replicate), data=greenroofNE)  #AIC = 515
summary(richmodel.n)
AIC(richmodel.n)
anova(richmodel.n)
rich.emm<-emmeans(richmodel.n,pairwise~design) #comparing SE and BE
rich.emm
#results: no difference btw SE and BE green roofs (p =0.2114)
rich.cld<-multcomp::cld(rich.emm, alpha = 0.05, Letters = LETTERS)
rich.cld
rich.emm.t<-emmeans(richmodel.n,pairwise~Trap)
rich.emm.t
#NOT INCLUDING
##Natural enemy abundance linear model
abunmodel.n <- lmer(abundance~Date + design + Trap + (1|Site:Replicate), data=greenroofNE)  #AIC = 1305
summary(abunmodel.n)
AIC(abunmodel.n)
anova(abunmodel.n)
abun.emm<-emmeans(abunmodel.n,pairwise~design)
abun.emm
#results: no difference btw SE and BE roofs (p=0.0947)
abun.cld<-multcomp::cld(abun.emm, alpha = 0.05, Letters = LETTERS)
abun.cld
abun.emm.t<-emmeans(abunmodel.n,pairwise~Trap)
abun.emm.t
##Natural enemy diversity linear model
divmodel.n <- lmer(diversity~Date + design + Trap + (1|Site:Replicate), data=greenroofNE)  #AIC = 70
summary(divmodel.n)
AIC(divmodel.n)
anova(divmodel.n)
div.emm<-emmeans(divmodel.n,pairwise~design)
div.emm
div.emm.t<-emmeans(divmodel.n,pairwise~Trap)
div.emm.t
#NOT INCLUDING
##Natural enemy evenness linear model
evenmodel.n <- lmer(evenness~Date + design + Trap + (1|Site:Replicate), data=greenroofNE)  #AIC = 72
summary(evenmodel.n)
AIC(evenmodel.n)
anova(evenmodel.n)
even.emm<-emmeans(evenmodel.n,pairwise~design)
even.emm
even.emm.t<-emmeans(evenmodel.n,pairwise~Trap)
even.emm.t
richness.plot.n_gr<-ggplot(greenroofNE,aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = richness, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=rich.cld, aes(y = 25, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
richness.plot.n_gr
#site abundance by site type
abundance.plot.n_gr<-ggplot(greenroofNE, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = abundance, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=abun.cld, aes(y = 25, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
abundance.plot.n_gr
#site diversity by site type
diversity.plot.n_gr<-ggplot(greenroofNE, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = diversity, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Diversity")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=div.cld.s, aes(y = 2, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
diversity.plot.n_gr
#site evenness by site type
evenness.plot.n_gr<-ggplot(greenroofNE, aes(x = factor(sitetype,level = c("Natural","Greenroof")), y = evenness, fill=Site))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
#theme (plot.title = element_text(hjust=0.5))+
#geom_text(data=even.cld.s, aes(y = 25, label = .group))+
scale_fill_brewer(palette="Paired",name="Sites:",
breaks=c("BFB", "DGM", "SSH", "EWB", "WSC", "HDB", "SNC"),
labels=c("Bedford barren","Dusty goldenrod meadow", "Slate shale hill", "Edgewater beach", "Watershed stewardship center", "Happy dog bike box", "Shaker Lakes nature center"))
evenness.plot.n_gr
naturalenemy.gr_boxplot <- ggarrange(richness.plot.n_gr, diversity.plot.n_gr,
ncol = 1, nrow = 2,
common.legend = TRUE, legend = "bottom")
naturalenemy.gr_boxplot
pdf("naturalenemy.gr_boxplot.pdf", height=8, width=8) #height and width in inches
naturalenemy.gr_boxplot
dev.off()
rich.emm<-emmeans(richmodel.n,pairwise~sitetype) #comparing natural vs GR
rich.emm
##Natural enemy richness linear model
richmodel.n <- lmer(richness~Date + sitetype + Trap + (1|Site:Replicate), data=NE)  #AIC = 1104
summary(richmodel.n)
AIC(richmodel.n)
anova(richmodel.n)
rich.emm<-emmeans(richmodel.n,pairwise~sitetype) #comparing natural vs GR
rich.emm
rich.emm<-emmeans(richmodel.n,pairwise~sitetype) #comparing natural vs GR
rich.emm
#results: no difference between natural (higher) and green roofs (p = 0.115)
rich.cld<-multcomp::cld(rich.emm, alpha = 0.05, Letters = LETTERS)
rich.cld
##Natural enemy diversity linear model
divmodel.n <- lmer(diversity~Date + sitetype + Trap + (1|Site:Replicate), data=NE)  #AIC = 275
summary(divmodel.n)
AIC(divmodel.n)
anova(divmodel.n)
div.emm<-emmeans(divmodel.n,pairwise~sitetype)
div.emm
rich.emm<-emmeans(richmodel.n,pairwise~sitetype) #comparing natural vs GR
rich.emm.t<-emmeans(richmodel.n,pairwise~Trap)
rich.emm.t
div.emm.t<-emmeans(divmodel.n,pairwise~Trap)
div.emm.t
##Natural GR enemy richness linear model
richmodel.n <- lmer(richness~Date + design + Trap + (1|Site:Replicate), data=greenroofNE)  #AIC = 569
rich.emm<-emmeans(richmodel.n,pairwise~design) #comparing SE and BE
rich.emm
##Natural enemy diversity linear model
divmodel.n <- lmer(diversity~Date + design + Trap + (1|Site:Replicate), data=greenroofNE)  #AIC = 129
summary(divmodel.n)
AIC(divmodel.n)
anova(divmodel.n)
div.emm<-emmeans(divmodel.n,pairwise~design)
div.emm
rich.emm.t<-emmeans(richmodel.n,pairwise~Trap)
rich.emm.t
div.emm.t<-emmeans(divmodel.n,pairwise~Trap)
div.emm.t
#trap names
ramps19$Trap="ramp"
jars21$Trap="jar"
#merge
library (plyr)
ramps <- rbind.fill (ramps19, jars21)
View(ramps)
View(ramps19)
insects.abun <- rowSums(ramps19[,5:44])
ramps19$abundance <- insects.abun
insects.rowsums <- rowSums(ramps19[,5:44]>0)
ramps19$richness <- insects.rowsums
#need vegan to run diversity and evenness
diversity <-diversity(ramps19[,5:44])
ramps19$diversity <-diversity
evenness <-diversity/log(specnumber(ramps19[,5:44]))
ramps19$evenness <- evenness
insects.abun <- rowSums(jars21[,5:44])
jars21$abundance <- insects.abun
insects.rowsums <- rowSums(jars21[,5:44]>0)
jars21$richness <- insects.rowsums
diversity <-diversity(jars21[,5:44])
jars21$diversity <-diversity
evenness <-diversity/log(specnumber(jars21[,5:44]))
jars21$evenness <- evenness
mean(ramps19$abundance) #72.35
sd(ramps19$abundance)/sqrt(10) #58.84
mean(ramps19$richness) #5.82
sd(ramps19$richness)/sqrt(10) #0.88
mean(ramps19$diversity) #1.16
sd(ramps19$diversity)/sqrt(10) #0.15
mean(ramps19$evenness) #0.71
sd(ramps19$evenness)/sqrt(10) #0.06
mean(jars21$abundance) #7.43
sd(jars21$abundance)/sqrt(10) #3.84
mean(jars21$richness) #2.46
sd(jars21$richness)/sqrt(10) #0.54
mean(jars21$diversity) #0.59
sd(jars21$diversity)/sqrt(10) #0.19
mean(jars21$evenness) #NA
sd(jars21$evenness)/sqrt(10) #NA
#Create matrix of environmental variables
env.matrix_ramps<-ramps[c(1:4,45)]
#create matrix of community variables
com.matrix_ramps<-ramps[c(5:44)]
#species accumulation
library (BiodiversityR)
library(ggplot2)
#individual curves for each trap type
ramp.com.matrix<-ramps19[c(5:44)]
ramp_curve<-accumresult(ramp.com.matrix, method = "exact", permutations = 1000)
jar.com.matrix<-jars21[c(5:44)]
jar_curve<-accumresult(jar.com.matrix, method = "exact", permutations = 1000)
#calculates order richness for each sample
specnumber(com.matrix_ramps) #ranges from 1 to 14
#calculates order richness by treatment (trap)
specnumber(com.matrix_ramps, groups = ramps$Trap) #jar=19; ramp=29
#total richness and jackknife
rich <- diversityresult(com.matrix_ramps, y=NULL, index = "richness")
rich # 32
j1 <- diversityresult(com.matrix_ramps, y=NULL, index = "jack1")
j1 # 34.976
#91%
j2 <- diversityresult(com.matrix_ramps, y=NULL, index = "jack2")
j2 # 31.095548
#ramp jackknife; richness = 29
j1.r <- diversityresult(ramp.com.matrix, y=NULL, index = "jack1")
j1.r # 31.95
#91%
j2.r <- diversityresult(ramp.com.matrix, y=NULL, index = "jack2")
j2.r # 30.098588
#jar jackknife; richness = 19
j1.j <- diversityresult(jar.com.matrix, y=NULL, index = "jack1")
j1.j # 23.923077
#79%
j2.j <- diversityresult(jar.com.matrix, y=NULL, index = "jack2")
j2.j # 23.998798
#BiodiversityR::accumcomp
Accum.1 <- accumcomp(com.matrix_ramps, y=env.matrix_ramps, factor='Trap',
method='random', conditioned=FALSE, plotit=FALSE)
Accum.1
#BiodiversityR::accumcomp.long
accum.long1 <- accumcomp.long(Accum.1, ci=NA, label.freq=5)
head(accum.long1)
#plot
#empty canvas
BioR.theme <- theme(
panel.background = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.line = element_line("gray25"),
text = element_text(size = 12),
axis.text = element_text(size = 10, colour = "gray25"),
axis.title = element_text(size = 14, colour = "gray25"),
legend.title = element_text(size = 14),
legend.text = element_text(size = 14),
legend.key = element_blank())
accum <- ggplot(data=accum.long1, aes(x = Sites, y = Richness, ymax = UPR, ymin = LWR)) +
scale_x_continuous(expand=c(0, 1), sec.axis = dup_axis(labels=NULL, name=NULL)) +
scale_y_continuous(sec.axis = dup_axis(labels=NULL, name=NULL)) +
scale_color_manual(values=c("gray","black"))+
scale_shape_manual(values=c(19,17,15,25))+
geom_line(aes(colour=Grouping), size=0.1) +
geom_ribbon(aes(colour=Grouping, fill=after_scale(alpha(colour, 0.3))),
show.legend=FALSE, linetype = 0) +
geom_point(data=subset(accum.long1, labelit==TRUE),
aes(colour=Grouping, shape=Grouping), size=3) +
BioR.theme +
labs(x = "Number of samples", y = "Richness", colour = "Trap", shape = "Trap")
accum
pdf("accum curves.pdf", height=6, width=8) #height and width in inches
accum
dev.off()
#bring in data pooled by date-site
allbugs_pooled <- read.csv("https://raw.githubusercontent.com/katiemmanning/Cleveland-insects/main/allbugs_2019%20and%202021_pooled.csv", na.strings = NULL)
#bring in beneficial insects taxa info
taxa <- read.csv("https://raw.githubusercontent.com/katiemmanning/Cleveland-insects/main/allbugs_taxa.csv", na.strings=NULL)
#Create matrix of environmental variables
env.matrix<-allbugs_pooled[c(1:3)]
#create matrix of community variables
com.matrix<-allbugs_pooled[c(4:43)]
#change to presence/absence
com.matrix[com.matrix > 0] <- 1
str(com.matrix)
#ordination by NMDS
NMDS<-metaMDS(com.matrix, distance="jaccard", k=2, autotransform=TRUE, trymax=300)
NMDS
###stress = 0.20
stressplot(NMDS)
#what taxa to display using "taxa"
pollinator<-as.vector(t(taxa[1,]))
pollinator<-pollinator[-1]
natural_enemies<-as.vector(t(taxa[2,]))
natural_enemies<-natural_enemies[-1]
include<-as.vector(t(taxa[3,]))
include<-include[-1]
#plot NMDS
#might need to change colors
#8 x 13
plot(NMDS, disp='sites', type="n")
#title(main="Arthropod community composition by site type", cex.main=1.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDS, env.matrix$sitetype, draw="polygon", col="#009E73",kind="sd", conf=0.95, label=FALSE, show.groups = "Greenroof")
ordiellipse(NMDS, env.matrix$sitetype, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Natural")
#add data points
points(NMDS, display="sites", select=which(env.matrix$sitetype=="Natural"),pch=19, col="#E69F00")
points(NMDS, display="sites", select=which(env.matrix$sitetype=="Greenroof"), pch=17, col="#009E73")
#add legend
legend(0.92,0.68, title=NULL, pch=c(19,17), col=c("#E69F00","#009E73"), cex=1.5, legend=c("Natural", "Greenroof"))
#add insect taxa as text
ordilabel(NMDS, display="species", select =which (include==TRUE & pollinator == TRUE), cex=0.6, col="black", fill="white")
ordilabel(NMDS, display="species", select =which (include==TRUE & natural_enemies == TRUE), cex=0.6, col="white", fill="black")
#bootstrapping and testing for differences between the groups (regions)
fit<-adonis(com.matrix ~ sitetype, data = env.matrix, permutations = 999, method="bray")
fit
#check assumption of homogeneity of multivariate dispersion
#P-value greater than 0.05 means assumption has been met
distances_data<-vegdist(com.matrix)
anova(betadisper(distances_data, env.matrix$sitetype))
#NMDS of natural versus SE green roof
SE <- read.csv("https://raw.githubusercontent.com/katiemmanning/Cleveland-insects/main/allbugs_pooled_SE%20and%20natural.csv", na.strings=NULL)
#Create matrix of environmental variables
env.matrix_SE<-SE[c(1:3)]
#create matrix of community variables
com.matrix_SE<-SE[c(4:43)]
#change to presence/absence
com.matrix_SE[com.matrix_SE > 0] <- 1
str(com.matrix_SE)
rowSums(com.matrix_SE)
#ordination by NMDS
NMDS_SE<-metaMDS(com.matrix_SE, distance="bray", k=2, autotransform=TRUE, trymax=300)
NMDS_SE
#ordination by NMDS
NMDS_SE<-metaMDS(com.matrix_SE, distance="jaccard", k=2, autotransform=TRUE, trymax=300)
NMDS_SE
###stress = 0.18
stressplot(NMDS_SE)
#plot
plot(NMDS_SE, disp='sites', type="n")
#add ellipsoids with ordiellipse
ordiellipse(NMDS_SE, env.matrix_SE$type, draw="polygon", col="#009E73",kind="sd", conf=0.95, label=FALSE, show.groups = "SE")
ordiellipse(NMDS_SE, env.matrix_SE$type, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Natural")
#add data points
points(NMDS_SE, display="sites", select=which(env.matrix_SE$type=="Natural"),pch=19, col="#E69F00")
points(NMDS_SE, display="sites", select=which(env.matrix_SE$type=="SE"), pch=17, col="#009E73")
#bootstrapping and testing for differences between the groups (SE and natural)
fit<-adonis(com.matrix_SE ~ type, data = env.matrix_SE, permutations = 999, method="bray")
fit
#NMDS of natural versus BE green roof
BE <- read.csv("https://raw.githubusercontent.com/katiemmanning/Cleveland-insects/main/allbugs_pooled_BE%20and%20natural.csv", na.strings=NULL)
#Create matrix of environmental variables
env.matrix_BE<-BE[c(1:3)]
#create matrix of community variables
com.matrix_BE<-BE[c(4:43)]
#change to presence/absence
com.matrix_BE[com.matrix_BE > 0] <- 1
str(com.matrix_BE)
rowSums(com.matrix_BE)
#ordination by NMDS
NMDS_BE<-metaMDS(com.matrix_BE, distance="jaccard", k=2, autotransform=TRUE, trymax=300)
NMDS_BE
###stress = 0.18
stressplot(NMDS_BE)
plot(NMDS_BE, disp='sites', type="n")
#add ellipsoids with ordiellipse
ordiellipse(NMDS_BE, env.matrix_BE$type, draw="polygon", col="#CC79A7",kind="sd", conf=0.95, label=FALSE, show.groups = "BE")
ordiellipse(NMDS_BE, env.matrix_BE$type, draw="polygon", col="#009E73",kind="sd", conf=0.95, label=FALSE, show.groups = "Natural")
#add data points
points(NMDS_BE, display="sites", select=which(env.matrix_BE$type=="Natural"),pch=19, col="#009E73")
points(NMDS_BE, display="sites", select=which(env.matrix_BE$type=="BE"), pch=17, col="#CC79A7")
#bootstrapping and testing for differences between the groups (BE and natural)
fit<-adonis(com.matrix_BE ~ type, data = env.matrix_BE, permutations = 999, method="bray")
fit
#check assumption of homogeneity of multivariate dispersion
#P-value greater than 0.05 means assumption has been met
distances_data<-vegdist(com.matrix_BE)
anova(betadisper(distances_data, env.matrix_BE$type))
#install.packages("devtools")
library(devtools)
install.packages("devtools")
#install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
library(pairwiseAdonis)
pairwise.adonis(com.matrix, env.matrix$sitetype)
#bring in data pooled by date-site
greenroofbugs_pooled <- read.csv("https://raw.githubusercontent.com/katiemmanning/Cleveland-insects/main/greenroofbugs_2019%20and%202021_pooled.csv", na.strings = NULL)
#Create matrix of environmental variables
env.matrix_gr<-greenroofbugs_pooled[c(1:3)]
#create matrix of community variables
com.matrix_gr<-greenroofbugs_pooled[c(4:43)]
#change to presence/absence
com.matrix_gr[com.matrix_gr > 0] <- 1
str(com.matrix_gr)
rowSums(com.matrix_gr)
#ordination by NMDS
NMDS_gr<-metaMDS(com.matrix_gr, distance="jaccard", k=2, autotransform=TRUE, trymax=300)
NMDS_gr
###stress = 0.16
stressplot(NMDS_gr)
#bootstrapping and testing for differences between the groups (BE v SE)
fit<-adonis(com.matrix_gr ~ design, data = env.matrix_gr, permutations = 999, method="bray")
fit
#check assumption of homogeneity of multivariate dispersion
#P-value greater than 0.05 means assumption has been met
distances_data<-vegdist(com.matrix_gr)
anova(betadisper(distances_data, env.matrix_gr$design))
#bootstrapping and testing for differences between the groups (BE v SE)
fit<-adonis(com.matrix_gr ~ Site, data = env.matrix_gr, permutations = 999, method="bray")
fit
library (pairwiseAdonis)
pairwise.adonis(com.matrix_gr, env.matrix_gr$Site)
#check assumption of homogeneity of multivariate dispersion
#P-value greater than 0.05 means assumption has been met
distances_data<-vegdist(com.matrix_gr)
anova(betadisper(distances_data, env.matrix_gr$Site))
